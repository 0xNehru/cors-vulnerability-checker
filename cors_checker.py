import argparse
import requests

def check_cors_vulnerability(target_url, origin):
    headers = {'Origin': origin}
    try:
        response = requests.options(target_url, headers=headers)
        if 'Access-Control-Allow-Origin' in response.headers:
            print(f"{target_url}: CORS is enabled. Access-Control-Allow-Origin: {origin}")
        else:
            print(f"{target_url}: CORS is not enabled.")
    except requests.exceptions.RequestException as e:
        print(f"{target_url}: Error occurred: {e}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='CORS Vulnerability Checker')
    parser.add_argument('-l', '--urls', type=str, required=True, help='File containing list of URLs to check, one per line')
    args = parser.parse_args()

    origin = 'http://hello.com'

    with open(args.urls, 'r') as file:
        urls = file.readlines()
        for url in urls:
            url = url.strip()
            check_cors_vulnerability(url, origin)
